<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Algorithms Visualizer</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="container">
    <div class="main-layout">
        <aside class="controls">
            <div class="section">
                <h3>1. Nhập dữ liệu</h3>
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('text')">Text</button>
                    <button class="tab-btn" onclick="switchTab('file')">File .mtx</button>
                    <button class="tab-btn" onclick="switchTab('draw')">GUI</button>
                </div>

                <div id="tab-text" class="tab-content active">
                    <p class="hint">Nhập: Nguồn Đích Trọng_số (VD: 1 2 5)</p>
                    <textarea id="graph-input" placeholder="1 2 10&#10;2 3 5&#10;1 3 15"></textarea>
                    <button onclick="handleTextInput()">Tạo Đồ Thị</button>
                </div>

                <div id="tab-file" class="tab-content">
                    <p class="hint">Hỗ trợ định dạng Matrix Market (.mtx)</p>
                    <input type="file" id="file-input" accept=".mtx">
                    <button onclick="handleFileInput()">Tạo Đồ Thị</button>
                </div>

                <div id="tab-draw" class="tab-content">
                    <p class="hint">
                        - Sử dụng thanh công cụ trên bản đồ để Thêm Nút (Add Node) và Thêm Cạnh (Add Edge)<br>
                        - Click vào đối tượng để Xóa (Delete selected)<br>
                        - Double click vào cạnh để chỉnh sửa trọng số
                    </p>
                </div>
            </div>

            <hr>

            <div class="section">
                <h3>2. Thuật toán</h3>
                <select id="algo-select" onchange="toggleAlgoInputs()">
                    <option value="mst">Cây khung nhỏ nhất (Kruskal)</option>
                    <option value="shortest">Đường đi ngắn nhất (Dijkstra)</option>
                    <option value="dromd">Thống trị Roman kép (GA)</option>
                </select>

                <div id="shortest-inputs" style="display: none; margin-top: 10px;">
                    <input type="text" id="start-node" placeholder="Nút bắt đầu (VD: 1)">
                    <input type="text" id="end-node" placeholder="Nút kết thúc (VD: 3)">
                </div>

                <div id="dromd-inputs" style="display: none; margin-top: 10px;">
                    <div class="form-group">
                        <label for="pop-size">Số lượng cá thể (mặc định: 100):</label>
                        <input type="number" id="pop-size" value="100" min="1" step="1">
                    </div>

                    <div class="form-group">
                        <label for="generations">Số thế hệ (mặc định: 300):</label>
                        <input type="number" id="generations" value="300" min="1" step="1">
                    </div>

                    <div class="form-group">
                        <label for="pc">Xác suất lai ghép (mặc định: 0.9):</label>
                        <input type="number" id="pc" value="0.9" min="0" max="1" step="0.01">
                    </div>

                    <div class="form-group">
                        <label for="pm">Xác suất đột biến (mặc định: 0.3):</label>
                        <input type="number" id="pm" value="0.3" min="0" max="1" step="0.01">
                    </div>
                </div>

                <button class="run-btn" onclick="runAlgorithm()">Chạy Thuật Toán</button>
                <button class="reset-color-btn" onclick="resetColor()">Reset Màu</button>
                <button class="reset-graph-btn" onclick="resetGraph()">Reset Đồ Thị</button>
            </div>

            <div class="section">
                <h3>Kết quả:</h3>
                <div id="result-text">...</div>

                <div id="legend-container" class="legend-container" style="display: none;">
                    <h4>Chú thích màu:</h4>
                    <div class="legend-item">
                        <span class="color-box" style="background-color: #FF4136;"></span>
                        <span>Label 3</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background-color: #2ECC40;"></span>
                        <span>Label 2</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background-color: #DDDDDD;"></span>
                        <span>Label 0</span>
                    </div>
                </div>
            </div>
        </aside>

        <main id="network-container">
            <div id="network"></div>
        </main>
    </div>

    <div id="loading-overlay" class="hidden">
        <div class="loader-box">
            <div class="spinner"></div>
            <p>Đang tính toán...</p>
            <button onclick="cancelAlgorithm()" class="btn-cancel-request">Hủy</button>
        </div>
    </div>
</div>

<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<script src="/static/scripts.js"></script>

</body>
</html>
